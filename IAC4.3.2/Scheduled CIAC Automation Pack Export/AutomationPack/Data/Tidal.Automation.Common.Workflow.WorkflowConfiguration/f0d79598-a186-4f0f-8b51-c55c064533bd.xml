<?xml version="1.0"?>
<WorkflowConfiguration xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xml:space="preserve">
  <Id>f0d79598-a186-4f0f-8b51-c55c064533bd</Id>
  <DisplayName>Export Automation Packs</DisplayName>
  <VersionNumber>17</VersionNumber>
  <CreatedTime>2016-02-16T19:38:30.4052734Z</CreatedTime>
  <ModifiedTime>2016-03-21T18:00:48.03125Z</ModifiedTime>
  <FirstActivity xsi:type="RootNode">
    <Id>56304cf8-8afd-4ebc-a2e8-9f7e8a8314d9</Id>
    <DisplayName />
    <Children>
      <ActivityNode xsi:type="StartProcessNode">
        <Id>4849e8b7-23af-4b6a-a4ea-f05158e1c9da</Id>
        <DisplayName>Convert Multiline to Comma Separated String</DisplayName>
        <Children>
          <ActivityNode xsi:type="FailedBranchPlaceholderNode">
            <Id>24266df4-bd22-418c-b85f-829538a40994</Id>
            <ProcessNodeId>4849e8b7-23af-4b6a-a4ea-f05158e1c9da</ProcessNodeId>
            <CompletedId>376ed656-0da8-4d61-852c-db687c3be0f1</CompletedId>
          </ActivityNode>
        </Children>
        <ProcessId>13ef6c78-f316-4dce-bcbe-1ddb5293471f</ProcessId>
        <InputVariableTable>
          <VariableAssignmentsAsArray>
            <InputVariableAssignment>
              <InputVariableId>a66275af-ce8b-4ebd-bc90-b282b60bb143</InputVariableId>
              <VariableValue xsi:type="SubstitutableString">
                <FormattedCode>{0}</FormattedCode>
                <References>
                  <VariableReference xsi:type="PropertyReference">
                    <DisplayPath>Process.Variables.Input.Export Automation Pack Names</DisplayPath>
                    <LinkChain />
                    <ObjectId>8027155a-0e64-4e6f-8783-ce1d13afa6a2</ObjectId>
                    <ObjectType>GlobalVariable</ObjectType>
                  </VariableReference>
                </References>
              </VariableValue>
            </InputVariableAssignment>
          </VariableAssignmentsAsArray>
        </InputVariableTable>
        <Asynchronous>false</Asynchronous>
        <InheritTarget>false</InheritTarget>
        <TargetLoadBalancer xsi:type="SingleTargetReferenceLoadBalancer">
          <SingleTargetReference>
            <FormattedCode />
            <HardcodedValue>
              <Id>bd4b3145-4e20-42bb-ba8f-34c013ca86cc</Id>
              <ObjectType>Target</ObjectType>
            </HardcodedValue>
          </SingleTargetReference>
        </TargetLoadBalancer>
        <InheritPriorityClass>true</InheritPriorityClass>
        <RuntimeUserId>
          <HardcodedValue>00000000-0000-0000-0000-000000000000</HardcodedValue>
        </RuntimeUserId>
        <KnowledgeBaseId>00000000-0000-0000-0000-000000000000</KnowledgeBaseId>
        <StartPointId>
          <HardcodedValue>00000000-0000-0000-0000-000000000000</HardcodedValue>
        </StartPointId>
        <StartPointName>
          <FormattedCode />
        </StartPointName>
      </ActivityNode>
      <ActivityNode xsi:type="ExecuteActivityNode">
        <Id>238df19f-74fe-4061-8d9c-b24e83a1bd01</Id>
        <DisplayName>Refresh SVN sandbox</DisplayName>
        <Children>
          <ActivityNode xsi:type="FailedBranchPlaceholderNode">
            <Id>249b5968-67c5-4242-8ffc-e0f5ccb9edf7</Id>
            <ActivityNodeId>238df19f-74fe-4061-8d9c-b24e83a1bd01</ActivityNodeId>
            <CompletedId>f6833bc7-cc11-4c4c-9ae5-d9a723e38b34</CompletedId>
          </ActivityNode>
        </Children>
        <Configuration xsi:type="WindowsPowerShellScriptActivityConfiguration" xml:space="preserve">
          <Id>238df19f-74fe-4061-8d9c-b24e83a1bd01</Id>
          <DisplayName>Refresh SVN sandbox</DisplayName>
          <Description>This script checks out a SVN URL into a specified directory. 

If the specified SvnSandbox is an existing SVN sandbox, it will be deleted and recreated. 
If the specified SvnSandbox directory exists and is not an existing SVN sandbox, the script will exit. 
If the specified SVNSandbox does not exist, it will be created.</Description>
          <TargetLoadBalancer xsi:type="ProcessTargetLoadBalancer" />
          <ContainingProcessId>f81b3da4-b280-4a1b-aa06-2374605aedf1</ContainingProcessId>
          <WorkingDirectory>
            <HardcodedValue />
          </WorkingDirectory>
          <FailReturnCodeNonZero>true</FailReturnCodeNonZero>
          <UseTaskScheduler>false</UseTaskScheduler>
          <TimeWindow>
            <Milliseconds>540000</Milliseconds>
            <Units>Minutes</Units>
          </TimeWindow>
          <Script>
            <HardcodedValue>&lt;# 
#get-svn-sandbox
#
#if directory exists
#	if directory is not empty
#		if directory is a svn directory
#			remove directory
#		else
#			exit fail
#		endif
#	endif
#else
#   create directory
#endif
#
# check out sources
#&gt;

param(
   [parameter(Mandatory=$true)] [String]$SvnUrl,
   [parameter(Mandatory=$true)] [String]$SvnSandbox
)

&lt;#
.SYNOPSIS
Checks out a fresh SVN sandbox

.DESCRIPTION
This script checks out a SVN URL into a specified directory. 

If the specified SvnSandbox is an existing SVN sandbox, it will be deleted and recreated. 
If the specified SvnSandbox directory exists and is not an existing SVN sandbox, the script will exit. 
If the specified SVNSandbox does not exist, it will be created.

.PARAMETER SvnUrl
The URL for the SVN repository/directory to check out. 

.PARAMETER SvnSandbox
The destination directory for the svn checkout. 

.EXAMPLE
get-svn-sandbox http://svn.example.com/svn/trunk c:\sandbox
#&gt;

If ((Test-Path -path $SvnSandbox) -eq $true)
{
	Write-Output("SVN sandbox directory ""$SvnSandbox"" already exists");

	$targetDirectoryInfo = Get-ChildItem $SvnSandbox | Measure-Object

	If ($targetDirectoryInfo.count -gt 0)
	{
		&amp;svn info $SvnSandbox 2&gt;&amp;1 | out-null
		$ExitCode = $LastExitCode
        If ($ExitCode -gt 0)
		{
			Write-Output("Directory ""$SvnSandbox"" is not a svn directory. Will not purge it. Exiting.");
			exit  -1
		}
		else
		{
			Write-Output("Deleting old svn sandbox ""$SvnSandbox""")
			Remove-Item -Recurse -Force $SvnSandbox
		}	
	}
}
Write-Output("Checking out svn dir")
Write-Output("svn -q co $SvnURL $SvnSandbox")
&amp;svn -q --username iac-build.gen --password iac40lee co $SvnURL $SvnSandbox 
# &amp;svn -q co $SvnURL $SvnSandbox 
exit $LastExitCode</HardcodedValue>
          </Script>
          <Arguments>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.SVN AutomationPack URL</DisplayPath>
                  <LinkChain />
                  <ObjectId>f2c49e6a-fd7d-4cf3-9d82-0db0a2b7e13d</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.Automation Packs SVN Path</DisplayPath>
                  <LinkChain />
                  <ObjectId>13161e49-b76f-4af7-a547-baf01bb44f9d</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
          </Arguments>
          <Use32BitPowerShell>false</Use32BitPowerShell>
        </Configuration>
      </ActivityNode>
      <ActivityNode xsi:type="SwitchNode">
        <Id>29ab70d8-c1c3-4287-bdff-1e6cd7c09cda</Id>
        <DisplayName>SVN checkout success or failure?</DisplayName>
        <Children>
          <ActivityNode xsi:type="ConditionBranchNode">
            <Id>d07dca11-ae2b-4c04-b4e4-94c7fc5132f1</Id>
            <DisplayName>SVN Checkout Succeeded?</DisplayName>
            <Children />
            <Condition>
              <Id>0310bdfd-5c1e-4e66-bb74-063bb85383cc</Id>
              <Conditions>
                <ConditionDefinition xsi:type="VariableConditionDefinition">
                  <Id>3d85bffe-b7d9-44bc-9fb5-661bdbc13de3</Id>
                  <Expression xsi:type="SubstitutableBoolean">
                    <HardcodedValue>false</HardcodedValue>
                  </Expression>
                  <Comparison>Equals</Comparison>
                  <VariableReference xsi:type="PropertyReference">
                    <DisplayPath>Workflow.Refresh SVN sandbox.Instance Failed</DisplayPath>
                    <LinkChain>
                      <Link xsi:type="PropertyNameLink">
                        <PropertyName>InstanceFailed</PropertyName>
                      </Link>
                    </LinkChain>
                    <ObjectId>238df19f-74fe-4061-8d9c-b24e83a1bd01</ObjectId>
                    <ObjectType>ActivityInstance</ObjectType>
                  </VariableReference>
                </ConditionDefinition>
              </Conditions>
            </Condition>
          </ActivityNode>
          <ActivityNode xsi:type="ConditionBranchNode">
            <Id>d9c4d65e-8fdc-43f0-8afa-509be70e84d7</Id>
            <DisplayName>SVN Checkout Failed?</DisplayName>
            <Children>
              <ActivityNode xsi:type="ExecuteActivityNode">
                <Id>ca237f74-c199-4f01-b5ce-1960dd584167</Id>
                <DisplayName>Email - Checkout failed</DisplayName>
                <Children>
                  <ActivityNode xsi:type="FailedBranchPlaceholderNode">
                    <Id>8721bac6-0ede-46cd-8e5b-68e910bc7061</Id>
                    <ActivityNodeId>ca237f74-c199-4f01-b5ce-1960dd584167</ActivityNodeId>
                    <CompletedId>3712471c-43d6-4e23-b88b-000ac2889c28</CompletedId>
                  </ActivityNode>
                </Children>
                <Configuration xsi:type="EmailActivityConfiguration" xml:space="preserve">
                  <Id>ca237f74-c199-4f01-b5ce-1960dd584167</Id>
                  <DisplayName>Email - Checkout failed</DisplayName>
                  <TargetLoadBalancer xsi:type="SingleTargetReferenceLoadBalancer">
                    <SingleTargetReference>
                      <FormattedCode />
                      <HardcodedValue>
                        <Id>8817dee9-f402-462f-b5dd-7337716c2d68</Id>
                        <ObjectType>Target</ObjectType>
                      </HardcodedValue>
                    </SingleTargetReference>
                  </TargetLoadBalancer>
                  <InheritTarget>false</InheritTarget>
                  <ContainingProcessId>f81b3da4-b280-4a1b-aa06-2374605aedf1</ContainingProcessId>
                  <Server>
                    <FormattedCode>{0}</FormattedCode>
                    <References>
                      <VariableReference xsi:type="PropertyReference">
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>DefaultEmailServer</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                        <ObjectType>Adapter</ObjectType>
                      </VariableReference>
                    </References>
                  </Server>
                  <Port>
                    <FormattedCode>{0}</FormattedCode>
                    <References>
                      <VariableReference xsi:type="PropertyReference">
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>DefaultEmailPort</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                        <ObjectType>Adapter</ObjectType>
                      </VariableReference>
                    </References>
                  </Port>
                  <From>
                    <FormattedCode>{0}</FormattedCode>
                    <References>
                      <VariableReference xsi:type="PropertyReference">
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>DefaultEmailSender</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                        <ObjectType>Adapter</ObjectType>
                      </VariableReference>
                    </References>
                  </From>
                  <To>
                    <FormattedCode>{0}</FormattedCode>
                    <References>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Process.Variables.Input.Email Addresses</DisplayPath>
                        <LinkChain />
                        <ObjectId>f38f3101-cff9-4319-a69e-f8ae799668ef</ObjectId>
                        <ObjectType>GlobalVariable</ObjectType>
                      </VariableReference>
                    </References>
                  </To>
                  <Cc>
                    <HardcodedValue />
                  </Cc>
                  <Bcc>
                    <HardcodedValue />
                  </Bcc>
                  <Subject>
                    <HardcodedValue>CIAC 4.0 TAPs Auto Checkin - sandbox checkout failed</HardcodedValue>
                  </Subject>
                  <Message>
                    <FormattedCode>Failed to check out SVN URL {0} to {1}.

Error Information:
{2}

Output:
{3}

Return Code:
{4}


</FormattedCode>
                    <References>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Process.Variables.Input.SVN AutomationPack URL</DisplayPath>
                        <LinkChain />
                        <ObjectId>f2c49e6a-fd7d-4cf3-9d82-0db0a2b7e13d</ObjectId>
                        <ObjectType>GlobalVariable</ObjectType>
                      </VariableReference>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Process.Variables.Input.Automation Packs SVN Path</DisplayPath>
                        <LinkChain />
                        <ObjectId>13161e49-b76f-4af7-a547-baf01bb44f9d</ObjectId>
                        <ObjectType>GlobalVariable</ObjectType>
                      </VariableReference>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Workflow.Refresh SVN sandbox.Error Information</DisplayPath>
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>ErrorInformation</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>238df19f-74fe-4061-8d9c-b24e83a1bd01</ObjectId>
                        <ObjectType>ActivityInstance</ObjectType>
                      </VariableReference>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Workflow.Refresh SVN sandbox.Output</DisplayPath>
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>Output</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>238df19f-74fe-4061-8d9c-b24e83a1bd01</ObjectId>
                        <ObjectType>ActivityInstance</ObjectType>
                      </VariableReference>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Workflow.Refresh SVN sandbox.Return Code</DisplayPath>
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>ReturnCode</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>238df19f-74fe-4061-8d9c-b24e83a1bd01</ObjectId>
                        <ObjectType>ActivityInstance</ObjectType>
                      </VariableReference>
                    </References>
                  </Message>
                  <IsHtml>
                    <HardcodedValue>false</HardcodedValue>
                  </IsHtml>
                  <AttachmentUserId>
                    <HardcodedValue>00000000-0000-0000-0000-000000000000</HardcodedValue>
                  </AttachmentUserId>
                  <Attachments />
                </Configuration>
              </ActivityNode>
              <ActivityNode xsi:type="ConditionBranchNode">
                <Id>77dd5327-3ef4-49af-966b-43f14d22da66</Id>
                <DisplayName>SVN checkout failure node</DisplayName>
                <Children>
                  <ActivityNode xsi:type="CompletedNode">
                    <Id>b30a7b1a-0091-4484-aa73-01398534a592</Id>
                    <CompletedType>FailedNotCompleted</CompletedType>
                    <ResultMessage>
                      <FormattedCode>{0}</FormattedCode>
                      <References>
                        <VariableReference xsi:type="PropertyReference">
                          <DisplayPath>Workflow.Refresh SVN sandbox.Error Information</DisplayPath>
                          <LinkChain>
                            <Link xsi:type="PropertyNameLink">
                              <PropertyName>ErrorInformation</PropertyName>
                            </Link>
                          </LinkChain>
                          <ObjectId>238df19f-74fe-4061-8d9c-b24e83a1bd01</ObjectId>
                          <ObjectType>ActivityInstance</ObjectType>
                        </VariableReference>
                      </References>
                    </ResultMessage>
                  </ActivityNode>
                </Children>
                <Condition>
                  <Id>0e6f3fa4-1bd7-4da4-9140-c529922f0607</Id>
                  <Conditions>
                    <ConditionDefinition xsi:type="VariableConditionDefinition">
                      <Id>4f810929-262e-49eb-ab09-554d59c14f8a</Id>
                      <Expression xsi:type="SubstitutableNumber">
                        <HardcodedValue>0</HardcodedValue>
                      </Expression>
                      <Comparison>NotEquals</Comparison>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Workflow.Refresh SVN sandbox.Return Code</DisplayPath>
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>ReturnCode</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>238df19f-74fe-4061-8d9c-b24e83a1bd01</ObjectId>
                        <ObjectType>ActivityInstance</ObjectType>
                      </VariableReference>
                    </ConditionDefinition>
                  </Conditions>
                </Condition>
              </ActivityNode>
            </Children>
            <Condition>
              <Id>d0e5dc65-e339-4341-b4af-b6ae12d73f14</Id>
              <Conditions />
            </Condition>
          </ActivityNode>
        </Children>
      </ActivityNode>
      <ActivityNode xsi:type="ExecuteActivityNode">
        <Id>dfbccf4c-901c-4817-8549-2790cdcaf5f1</Id>
        <DisplayName>Execute Windows PowerShell Script</DisplayName>
        <Children />
        <Configuration xsi:type="WindowsPowerShellScriptActivityConfiguration" xml:space="preserve">
          <Id>dfbccf4c-901c-4817-8549-2790cdcaf5f1</Id>
          <DisplayName>Execute Windows PowerShell Script</DisplayName>
          <TargetLoadBalancer xsi:type="ProcessTargetLoadBalancer" />
          <ContainingProcessId>f81b3da4-b280-4a1b-aa06-2374605aedf1</ContainingProcessId>
          <WorkingDirectory>
            <HardcodedValue />
          </WorkingDirectory>
          <FailReturnCodeNonZero>true</FailReturnCodeNonZero>
          <UseTaskScheduler>false</UseTaskScheduler>
          <TimeWindow>
            <Milliseconds>1800000</Milliseconds>
            <Units>Minutes</Units>
          </TimeWindow>
          <Script>
            <HardcodedValue>param(
   [parameter(Mandatory=$true)] [String] $TapExportPath,
   [parameter(Mandatory=$true)] [String] $SvnAutomationPacksPath,
   [parameter(Mandatory=$true)] [String] $ToolsPath,
   [parameter(Mandatory=$true)] [String] $ExportAutomationPackNames,
   [parameter(Mandatory=$true)] [String] $CheckinMessage,
   [parameter(Mandatory=$false)] [String] $CheckinTapOnly,
   [parameter(Mandatory=$true)] [String] $TAPSvnPath
)

#---------------------------------------------------------------------
# Register the PO custom snapin
#---------------------------------------------------------------------
Add-PSSnapin 'CorePSSnapin'

#---------------------------------------------------------------------
# Helper function to determine if the variable has value in it
#---------------------------------------------------------------------
function HasValue($Variable)
{
    If ($Variable)
    {
        $true
    }
    Else
    {
        $false
    }
}

#---------------------------------------------------------------------
# Check the input directory
#---------------------------------------------------------------------

# If TAP Export Path is not specified, exit the script and return -1
If ((HasValue $TapExportPath) -eq $false)
{
    Write-Output("The ""TAP Export Path"" parameter is not specified.");
    exit -1;
}

# If TAP Export Path does not exist, creates it
if ((Test-Path -path $TapExportPath) -eq $false)
{
    Write-Output("===================================================================")
    Write-Output("SETUP")
    Write-Output("===================================================================")
    New-Item -Path $TapExportPath -ItemType Directory &gt; $null
    Write-Output("Created export directory ""$TapExportPath""");
}

$AutomationPackDiffExePath = Join-Path $ToolsPath "AutomationPackDiff\AutomationPackDiff.exe"

Foreach ($ExportAutomationPackName in $ExportAutomationPackNames.split(','))
{
    Write-Output("`n===================================================================")
    Write-Output("$ExportAutomationPackName")
    Write-Output("===================================================================")

    $TapFileName = $ExportAutomationPackName.Trim() + '.tap'
    $TapFilePath = Join-Path $TapExportPath $TapFileName
    $SvnAutomationPackFilesPath = Join-Path $SvnAutomationPacksPath $ExportAutomationPackName

    Write-Output("Phase 1: export")
    Write-Output("-------------------------------------------------------------------")

    Write-Output("Exporting to ""$TapExportPath""...");
    Export-OrchestratorAutomationPack "$ExportAutomationPackName" -path "$TapFilePath"
    Write-Output("Exporting complete");

    Write-Output("-------------------------------------------------------------------")
    Write-Output("Phase 2: Extraction/checkin")
    Write-Output("-------------------------------------------------------------------")

    Try
    {
        Write-Output("Processing ""$TapFilePath""...");
        $Process = New-Object System.Diagnostics.Process
        $Process.StartInfo.Filename = "$AutomationPackDiffExePath"
        If ($CheckinTapOnly -eq "true")
        {
            $Process.StartInfo.Arguments = "-v:Errors  -AutomationPackFile:""$TapFilePath"" -Directory:""$SvnAutomationPackFilesPath"" -TapOnly -TapSvnDir:""$TAPSvnPath"" -Message:""$ExportAutomationPackName - $CheckinMessage"""
        }
        Else
        {
            $Process.StartInfo.Arguments = "-v:Errors -AutomationPackFile:""$TapFilePath"" -Directory:""$SvnAutomationPackFilesPath"" -TapSvnDir:""$TAPSvnPath"" -Message:""$ExportAutomationPackName -  $CheckinMessage"""
        }

        $Process.StartInfo.RedirectStandardOutput = $false
        $Process.StartInfo.UseShellExecute = $false
        Write-Output("Running AutomationPackDiff:`n")
        Write-Output("$($Process.StartInfo.filename) $($Process.StartInfo.Arguments)`n")
        $Process.start() | out-null

        $Process.WaitForExit()
        $ExitCode = $Process.ExitCode
        If ($ExitCode -ne 0)
        {
            Write-Output("Processing FAILED with error code ($ExitCode)");
            exit $ExitCode;
        }
        Else
        {
            Write-Output("Processing complete.");
        }
    }
    Catch [System.Exception]
    {
        Write-Output("Processing FAILED: An exception was raised.");
        exit  -1
    }
}
</HardcodedValue>
          </Script>
          <Arguments>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.TAP Export Path</DisplayPath>
                  <LinkChain />
                  <ObjectId>a6ac939e-de06-4ff2-aed1-8203cd166771</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.Automation Packs SVN Path</DisplayPath>
                  <LinkChain />
                  <ObjectId>13161e49-b76f-4af7-a547-baf01bb44f9d</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.Tools Path</DisplayPath>
                  <LinkChain />
                  <ObjectId>1e695fe8-93a4-4d1b-9eab-6d31e9fae398</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Workflow.Convert Multiline to Comma Separated String.Comma Separated String</DisplayPath>
                  <LinkChain>
                    <Link xsi:type="ProcessOutputVariableLink">
                      <LaunchingActivityId>4849e8b7-23af-4b6a-a4ea-f05158e1c9da</LaunchingActivityId>
                      <OutputVariableId>7f31a8f6-03cc-4249-b906-d0ae0fdef76d</OutputVariableId>
                    </Link>
                  </LinkChain>
                  <ObjectId>4849e8b7-23af-4b6a-a4ea-f05158e1c9da</ObjectId>
                  <ObjectType>WorkflowNode</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.Check In Message</DisplayPath>
                  <LinkChain />
                  <ObjectId>ec431cb2-6314-4b85-8663-349474e6a65a</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.Check in TAP File Only</DisplayPath>
                  <LinkChain />
                  <ObjectId>a120bfff-09f0-48c8-8fa8-f6180d6b9a97</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
            <SubstitutableObject xsi:type="SubstitutableString">
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Process.Variables.Input.TAP SVN Path</DisplayPath>
                  <LinkChain />
                  <ObjectId>4801f2b8-41ec-466a-9de2-9b02a30b7306</ObjectId>
                  <ObjectType>GlobalVariable</ObjectType>
                </VariableReference>
              </References>
            </SubstitutableObject>
          </Arguments>
          <Use32BitPowerShell>false</Use32BitPowerShell>
        </Configuration>
      </ActivityNode>
      <ActivityNode xsi:type="ConditionBranchNode">
        <Id>b0dead14-38dc-473a-8190-f08cec40e5a8</Id>
        <DisplayName>If Email Addresses Provided</DisplayName>
        <Children>
          <ActivityNode xsi:type="SwitchNode">
            <Id>06f8cca5-c219-4d48-aade-3672fe36cf4d</Id>
            <DisplayName>Export &amp; Checkin Successfully?</DisplayName>
            <Children>
              <ActivityNode xsi:type="ConditionBranchNode">
                <Id>6118a4c7-02e3-4f5b-aa0d-688eb922b7c5</Id>
                <DisplayName>Succeeded</DisplayName>
                <Children>
                  <ActivityNode xsi:type="ExecuteActivityNode">
                    <Id>dff20584-9d49-4fa9-9baa-fa61cd0b7b66</Id>
                    <DisplayName>Email - Checkin Succeeded</DisplayName>
                    <Children>
                      <ActivityNode xsi:type="ConditionBranchNode">
                        <Id>35c8074f-ab49-49c1-8357-8ddf0965f3ec</Id>
                        <Notes>If this execution fails, execute the contained workflow nodes.</Notes>
                        <DisplayName>If Execution Fails</DisplayName>
                        <Children />
                        <Condition>
                          <Id>3c9f0df7-0aa2-4365-83e2-15a4bef42fde</Id>
                          <Conditions>
                            <ConditionDefinition xsi:type="VariableConditionDefinition">
                              <Id>ec7aa9b3-75a9-4b9a-b657-91f6b34608c4</Id>
                              <Expression xsi:type="SubstitutableBoolean">
                                <HardcodedValue>true</HardcodedValue>
                              </Expression>
                              <Comparison>Equals</Comparison>
                              <VariableReference xsi:type="PropertyReference">
                                <LinkChain>
                                  <Link xsi:type="PropertyNameLink">
                                    <PropertyName>InstanceFailed</PropertyName>
                                  </Link>
                                </LinkChain>
                                <ObjectId>dff20584-9d49-4fa9-9baa-fa61cd0b7b66</ObjectId>
                                <ObjectType>ActivityInstance</ObjectType>
                              </VariableReference>
                            </ConditionDefinition>
                          </Conditions>
                        </Condition>
                      </ActivityNode>
                    </Children>
                    <Configuration xsi:type="EmailActivityConfiguration" xml:space="preserve">
                      <Id>dff20584-9d49-4fa9-9baa-fa61cd0b7b66</Id>
                      <DisplayName>Email - Checkin Succeeded</DisplayName>
                      <TargetLoadBalancer xsi:type="SingleTargetReferenceLoadBalancer">
                        <SingleTargetReference>
                          <FormattedCode />
                          <HardcodedValue>
                            <Id>8817dee9-f402-462f-b5dd-7337716c2d68</Id>
                            <ObjectType>Target</ObjectType>
                          </HardcodedValue>
                        </SingleTargetReference>
                      </TargetLoadBalancer>
                      <InheritTarget>false</InheritTarget>
                      <ContainingProcessId>f81b3da4-b280-4a1b-aa06-2374605aedf1</ContainingProcessId>
                      <Server>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>DefaultEmailServer</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                            <ObjectType>Adapter</ObjectType>
                          </VariableReference>
                        </References>
                      </Server>
                      <Port>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>DefaultEmailPort</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                            <ObjectType>Adapter</ObjectType>
                          </VariableReference>
                        </References>
                      </Port>
                      <From>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>DefaultEmailSender</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                            <ObjectType>Adapter</ObjectType>
                          </VariableReference>
                        </References>
                      </From>
                      <To>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Process.Variables.Input.Email Addresses</DisplayPath>
                            <LinkChain />
                            <ObjectId>f38f3101-cff9-4319-a69e-f8ae799668ef</ObjectId>
                            <ObjectType>GlobalVariable</ObjectType>
                          </VariableReference>
                        </References>
                      </To>
                      <Cc>
                        <HardcodedValue />
                      </Cc>
                      <Bcc>
                        <HardcodedValue />
                      </Bcc>
                      <Subject>
                        <HardcodedValue>CIAC 4.0 TAPs Auto Checkin - Succeeded</HardcodedValue>
                      </Subject>
                      <Message>
                        <FormattedCode>The following automation packs have been checked in to SVN successfully.
{0}

Output:
{1}
</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Process.Variables.Input.Export Automation Pack Names</DisplayPath>
                            <LinkChain />
                            <ObjectId>8027155a-0e64-4e6f-8783-ce1d13afa6a2</ObjectId>
                            <ObjectType>GlobalVariable</ObjectType>
                          </VariableReference>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Workflow.Execute Windows PowerShell Script.Output</DisplayPath>
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>Output</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>dfbccf4c-901c-4817-8549-2790cdcaf5f1</ObjectId>
                            <ObjectType>ActivityInstance</ObjectType>
                          </VariableReference>
                        </References>
                      </Message>
                      <IsHtml>
                        <HardcodedValue>false</HardcodedValue>
                      </IsHtml>
                      <AttachmentUserId>
                        <HardcodedValue>00000000-0000-0000-0000-000000000000</HardcodedValue>
                      </AttachmentUserId>
                      <Attachments />
                    </Configuration>
                  </ActivityNode>
                </Children>
                <Condition>
                  <Id>0e6f3fa4-1bd7-4da4-9140-c529922f0607</Id>
                  <Conditions>
                    <ConditionDefinition xsi:type="VariableConditionDefinition">
                      <Id>4f810929-262e-49eb-ab09-554d59c14f8a</Id>
                      <Expression xsi:type="SubstitutableBoolean">
                        <HardcodedValue>false</HardcodedValue>
                      </Expression>
                      <Comparison>Equals</Comparison>
                      <VariableReference xsi:type="PropertyReference">
                        <DisplayPath>Workflow.Execute Windows PowerShell Script.Instance Failed</DisplayPath>
                        <LinkChain>
                          <Link xsi:type="PropertyNameLink">
                            <PropertyName>InstanceFailed</PropertyName>
                          </Link>
                        </LinkChain>
                        <ObjectId>dfbccf4c-901c-4817-8549-2790cdcaf5f1</ObjectId>
                        <ObjectType>ActivityInstance</ObjectType>
                      </VariableReference>
                    </ConditionDefinition>
                  </Conditions>
                </Condition>
              </ActivityNode>
              <ActivityNode xsi:type="ConditionBranchNode">
                <Id>82e3e2c8-6c16-4595-b7ac-4b573967990c</Id>
                <DisplayName>Failed</DisplayName>
                <Children>
                  <ActivityNode xsi:type="ExecuteActivityNode">
                    <Id>4652a959-113a-48fe-ae64-eebf8b0905e5</Id>
                    <DisplayName>Email - Checkin Failed</DisplayName>
                    <Children>
                      <ActivityNode xsi:type="ConditionBranchNode">
                        <Id>1a5f748c-c581-4120-97c4-167f8ed1364b</Id>
                        <Notes>If this execution fails, execute the contained workflow nodes.</Notes>
                        <DisplayName>If Execution Fails</DisplayName>
                        <Children />
                        <Condition>
                          <Id>cb2b3991-98cd-424b-a785-943ab2d88590</Id>
                          <Conditions>
                            <ConditionDefinition xsi:type="VariableConditionDefinition">
                              <Id>9abd691b-d761-4b64-b280-b492b1bc36ec</Id>
                              <Expression xsi:type="SubstitutableBoolean">
                                <HardcodedValue>true</HardcodedValue>
                              </Expression>
                              <Comparison>Equals</Comparison>
                              <VariableReference xsi:type="PropertyReference">
                                <LinkChain>
                                  <Link xsi:type="PropertyNameLink">
                                    <PropertyName>InstanceFailed</PropertyName>
                                  </Link>
                                </LinkChain>
                                <ObjectId>4652a959-113a-48fe-ae64-eebf8b0905e5</ObjectId>
                                <ObjectType>ActivityInstance</ObjectType>
                              </VariableReference>
                            </ConditionDefinition>
                          </Conditions>
                        </Condition>
                      </ActivityNode>
                    </Children>
                    <Configuration xsi:type="EmailActivityConfiguration" xml:space="preserve">
                      <Id>4652a959-113a-48fe-ae64-eebf8b0905e5</Id>
                      <DisplayName>Email - Checkin Failed</DisplayName>
                      <TargetLoadBalancer xsi:type="SingleTargetReferenceLoadBalancer">
                        <SingleTargetReference>
                          <FormattedCode />
                          <HardcodedValue>
                            <Id>8817dee9-f402-462f-b5dd-7337716c2d68</Id>
                            <ObjectType>Target</ObjectType>
                          </HardcodedValue>
                        </SingleTargetReference>
                      </TargetLoadBalancer>
                      <InheritTarget>false</InheritTarget>
                      <ContainingProcessId>f81b3da4-b280-4a1b-aa06-2374605aedf1</ContainingProcessId>
                      <Server>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>DefaultEmailServer</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                            <ObjectType>Adapter</ObjectType>
                          </VariableReference>
                        </References>
                      </Server>
                      <Port>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>DefaultEmailPort</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                            <ObjectType>Adapter</ObjectType>
                          </VariableReference>
                        </References>
                      </Port>
                      <From>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>DefaultEmailSender</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>6458928f-0738-4525-92d5-97a675bda758</ObjectId>
                            <ObjectType>Adapter</ObjectType>
                          </VariableReference>
                        </References>
                      </From>
                      <To>
                        <FormattedCode>{0}</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Process.Variables.Input.Email Addresses</DisplayPath>
                            <LinkChain />
                            <ObjectId>f38f3101-cff9-4319-a69e-f8ae799668ef</ObjectId>
                            <ObjectType>GlobalVariable</ObjectType>
                          </VariableReference>
                        </References>
                      </To>
                      <Cc>
                        <HardcodedValue />
                      </Cc>
                      <Bcc>
                        <HardcodedValue />
                      </Bcc>
                      <Subject>
                        <HardcodedValue>CIAC 4.0 TAPs Auto Checkin - Failed</HardcodedValue>
                      </Subject>
                      <Message>
                        <FormattedCode>The following automation packs failed to check into SVN
{0}

Error Information:
{1}

Output:
{2}

Return Code:
{3}

</FormattedCode>
                        <References>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Process.Variables.Input.Export Automation Pack Names</DisplayPath>
                            <LinkChain />
                            <ObjectId>8027155a-0e64-4e6f-8783-ce1d13afa6a2</ObjectId>
                            <ObjectType>GlobalVariable</ObjectType>
                          </VariableReference>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Workflow.Execute Windows PowerShell Script.Error Information</DisplayPath>
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>ErrorInformation</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>dfbccf4c-901c-4817-8549-2790cdcaf5f1</ObjectId>
                            <ObjectType>ActivityInstance</ObjectType>
                          </VariableReference>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Workflow.Execute Windows PowerShell Script.Output</DisplayPath>
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>Output</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>dfbccf4c-901c-4817-8549-2790cdcaf5f1</ObjectId>
                            <ObjectType>ActivityInstance</ObjectType>
                          </VariableReference>
                          <VariableReference xsi:type="PropertyReference">
                            <DisplayPath>Workflow.Execute Windows PowerShell Script.Return Code</DisplayPath>
                            <LinkChain>
                              <Link xsi:type="PropertyNameLink">
                                <PropertyName>ReturnCode</PropertyName>
                              </Link>
                            </LinkChain>
                            <ObjectId>dfbccf4c-901c-4817-8549-2790cdcaf5f1</ObjectId>
                            <ObjectType>ActivityInstance</ObjectType>
                          </VariableReference>
                        </References>
                      </Message>
                      <IsHtml>
                        <HardcodedValue>false</HardcodedValue>
                      </IsHtml>
                      <AttachmentUserId>
                        <HardcodedValue>00000000-0000-0000-0000-000000000000</HardcodedValue>
                      </AttachmentUserId>
                      <Attachments />
                    </Configuration>
                  </ActivityNode>
                </Children>
                <Condition>
                  <Id>f551492c-efc7-4c46-8ca3-bcb274368acb</Id>
                  <Conditions />
                </Condition>
              </ActivityNode>
            </Children>
          </ActivityNode>
        </Children>
        <Condition>
          <Id>3fcc8221-2f3a-4325-ad93-b2e3908a3df2</Id>
          <Conditions>
            <ConditionDefinition xsi:type="VariableConditionDefinition">
              <Id>427dd224-3be3-45ab-9ce3-e8242179e659</Id>
              <Expression xsi:type="SubstitutableString">
                <HardcodedValue />
              </Expression>
              <Comparison>NotEquals</Comparison>
              <VariableReference xsi:type="PropertyReference">
                <DisplayPath>Process.Variables.Input.Email Addresses</DisplayPath>
                <LinkChain />
                <ObjectId>f38f3101-cff9-4319-a69e-f8ae799668ef</ObjectId>
                <ObjectType>GlobalVariable</ObjectType>
              </VariableReference>
            </ConditionDefinition>
          </Conditions>
        </Condition>
      </ActivityNode>
      <ActivityNode xsi:type="ConditionBranchNode">
        <Id>7004f428-c44f-4f10-a1ed-dcebc2b2ba51</Id>
        <DisplayName>Failed</DisplayName>
        <Children>
          <ActivityNode xsi:type="CompletedNode">
            <Id>235b5eb3-c0c1-42da-abb0-c07b3fa3fb88</Id>
            <CompletedType>FailedNotCompleted</CompletedType>
            <ResultMessage>
              <FormattedCode>{0}</FormattedCode>
              <References>
                <VariableReference xsi:type="PropertyReference">
                  <DisplayPath>Workflow.Execute Windows PowerShell Script.Error Information</DisplayPath>
                  <LinkChain>
                    <Link xsi:type="PropertyNameLink">
                      <PropertyName>ErrorInformation</PropertyName>
                    </Link>
                  </LinkChain>
                  <ObjectId>dfbccf4c-901c-4817-8549-2790cdcaf5f1</ObjectId>
                  <ObjectType>ActivityInstance</ObjectType>
                </VariableReference>
              </References>
            </ResultMessage>
          </ActivityNode>
        </Children>
        <Condition>
          <Id>0e6f3fa4-1bd7-4da4-9140-c529922f0607</Id>
          <Conditions>
            <ConditionDefinition xsi:type="VariableConditionDefinition">
              <Id>4f810929-262e-49eb-ab09-554d59c14f8a</Id>
              <Expression xsi:type="SubstitutableBoolean">
                <HardcodedValue>true</HardcodedValue>
              </Expression>
              <Comparison>Equals</Comparison>
              <VariableReference xsi:type="PropertyReference">
                <DisplayPath>Workflow.Execute Windows PowerShell Script.Instance Failed</DisplayPath>
                <LinkChain>
                  <Link xsi:type="PropertyNameLink">
                    <PropertyName>InstanceFailed</PropertyName>
                  </Link>
                </LinkChain>
                <ObjectId>dfbccf4c-901c-4817-8549-2790cdcaf5f1</ObjectId>
                <ObjectType>ActivityInstance</ObjectType>
              </VariableReference>
            </ConditionDefinition>
          </Conditions>
        </Condition>
      </ActivityNode>
    </Children>
  </FirstActivity>
  <ProcessId>f81b3da4-b280-4a1b-aa06-2374605aedf1</ProcessId>
</WorkflowConfiguration>